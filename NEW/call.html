<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta name="description" content="提供一个可以搜索游戏《魔法纪录》和《魔法少女小圆 Magia Exedra》中登场角色之间如何互相称呼的工具。">
	<base target="_top">
	<link rel="icon" type="image/x-icon" href="./img/webp/ファビコン.webp">
	<link rel="apple-touch-icon" sizes="180x180" href="./img/webp/apple_fabicon.webp">

	<title>魔法纪录·Magia Exedra 魔法少女称呼搜索</title>

	<!-- CSS文件读取 -->
	<link rel="stylesheet" href="./myfile/mycss.css">
	<link rel="stylesheet" href="./myfile/charaBox_png.css">
	<link rel="stylesheet" href="./myfile/hamburgerMenu.css">
	<!-- 此页面专属样式 -->
	<style>
		/* 关系网络图样式 */
		#mynetwork {
			/* width : 350px; */
			width: 90%;
			height: 400px;
			border: 1px solid lightgray;
			display: block;
			background: rgba(0, 0, 0, 1);
			margin: 0 auto;
		}

		#canvasflame {
			overflow: scroll;
		}

		#girltable {
			margin: 0 auto;
			border-collapse: separate;
			font-size: small;
		}
	</style>

	<!-- “返回顶部”、“前往底部”按钮 -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	<!-- 读取魔法少女筛选的javascript方法-->
	<script src="./myfile/mgirlNarrow.js"></script>
</head>

<body>
	<div id="wrapper">
		<!-- 汉堡菜单 -->
		<header class="header">
			<div class="navtext-container">
				<div class="navtext">魔法纪录·Magia Exedra 魔法少女称呼搜索</div>
			</div>
			<input type="checkbox" class="menu-btn" id="menu-btn">
			<label for="menu-btn" class="menu-icon"><span class="navicon"></span></label>
			<ul class="menu">
				<li class="menulabel">■通用</li>
				<li class="thismenu">称呼搜索</li>
				<li class="menulabel">■Magia Exedra</li>
				<li>
					<a href="https://app.the-timeline.jp/2PACX-1vQSTMVQlcv7SnwCc8NZgGTKry8U5ZehODwgI-F_GPx0FWjJF0M41L_j2N3asfgtdt58NRxoIjc4NJcN">
						运营时间表
					</a>
				</li>
				<li class="menulabel">■魔法纪录</li>
				<li>
					<a href="https://app.the-timeline.jp/2PACX-1vTYF8Mj66tnTEhK2jPwzJzwKWJgtC0Y2-PQGIUwVbkO9csvt1IofUzv0LO0X_bjVpVgKCDyel4_jEry">
						运营时间表
					</a>
				<li><a href="https://magireco-chara-search.vercel.app/mdkOCR/index.html">魔女文字解读工具</a></li>
				<li>
					<a href="https://docs.google.com/spreadsheets/d/1V0QTP3YZsoc7h5wOC8oqg7NKJpA6ZPyck9yCYfbJGlk/">
						称呼数据
					</a>
				</li>
				<li>
					<a href="https://docs.google.com/spreadsheets/d/1C5fS5cHm4fFwbspdp6Eq_-GC3DnWbm4-7lbXYucoDGA/edit?usp=sharing">
						活动·运营时间表(Exedra)
					</a>
				</li>
				<li>
					<a href="https://docs.google.com/spreadsheets/d/1iP2_UBIvnzQs5MnqOZHDRo7C88PukW46Bcf7wZXdj7g/edit?usp=sharing">
						活动·运营时间表(魔法纪录)
					</a>
				</li>
				<li>
					<a href="https://docs.google.com/spreadsheets/d/1isucgeJQxlF6EkkzTq9bVJ4xc2WTKDG_K85JGNk6Ihw/edit?usp=sharing">
						角色故事数据(魔法纪录)
					</a>
				</li>
				<li><a href="https://github.com/chiki3839/">源文件(GitHub)</a></li>
			</ul>
		</header>
		<!-- 汉堡菜单结束 -->
		<!--<H2 class="title">魔法纪录·Magia Exedra 魔法少女称呼搜索</H2>-->

		<span class="returnlink">
			<a href="https://docs.google.com/spreadsheets/d/1V0QTP3YZsoc7h5wOC8oqg7NKJpA6ZPyck9yCYfbJGlk/edit?usp=sharing">
				称呼一览表在此(可以添加评论，欢迎指出错误)
			</a>
		</span><BR>
		<p class="top">
			选择角色后，<span style="color:rgb(255, 0, 0);font-weight:bold;">点击右下角的</span>
			<i class="fa fa-share-alt-square" style="color:#f85ab6"></i>
			<span style="color:rgb(255, 0, 0);font-weight:bold;">或“搜索”按钮</span>
		</p>
		页面底部将显示称呼关系图和表格。(点击右下角的箭头可以上下移动)<BR>
		双击图标可以筛选称呼/被称呼的对象。<BR>
		</p>
		<fieldset class="calloption">
			<legend>双击选项</legend>
			<form id="callcate">
				<label><input type="radio" name="vector" value="call">称呼</label>
				<label><input type="radio" name="vector" value="called">被称呼</label>
				<label><input type="radio" name="vector" value="OR" checked="checked">双方</label>
				<label><input type="radio" name="vector" value="mutual">仅“互相称呼”</label>
				<label><input type="radio" name="vector" value="oneWay">仅单向</label>
			</form>
		</fieldset>
		<p>也可以通过名字的平假名、片假名或汉字进行筛选。</p>
		<!-- 魔法少女筛选文本输入 -->
		<input type="text" spellcheck="false" class="ndownword" name="ndownword"
			   placeholder="通过平假名、片假名、汉字姓名筛选。空格为OR。删除则返回" id="ndownword1" oninput="mgirlNarrow('call', 'ndownword1')">
		<input type="button" value="重置筛选" class="ndownReset" onClick="ndownReset('call')">

<!-- 【全新】功能按钮组 -->
<input type="button" value="取消选择" name="mgreset" class="mgreset" id="mgreset" onClick="return girlReset()">
<input type="button" name="call_search" class="mgr-10 searchbtn" value="称呼搜索" onClick="drawAndJump()">
<input type="button" name="height_search_selected" class="mgr-10 searchbtn" value="身高搜索 (选中)" onClick="displayHeightChart('selected')">
<input type="button" name="height_search_global" class="mgr-10 searchbtn" value="全局身高图" onClick="displayHeightChart('global')">
		<!-- 魔法少女复选框 -->
		<form name="magicalgirl">
			<div class="magicalgirl">

				<label class="girlbox umeColor" data-kana="たまき いろは"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="環いろは" value="环彩羽 (環いろは / Tamaki Iroha)"><br>环彩羽★</label>
				<label class="girlbox umeColor" data-kana="ななみ やちよ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="七海やちよ" value="七海八千代 (七海やちよ / Nanami Yachiyo)"><br>七海八千代★</label>
				<label class="girlbox umeColor" data-kana="ゆい つるの"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="由比鶴乃" value="由比鹤乃 (由比鶴乃 / Yui Tsuruno)"><br>由比鹤乃★</label>
				<label class="girlbox umeColor" data-kana="ふたば さな"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="二葉さな" value="二叶莎奈 (二葉さな / Futaba Sana)"><br>二叶莎奈★</label>
				<label class="girlbox umeColor" id="feri" data-kana="みつき ふぇりしあ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="深月フェリシア" value="深月菲莉希亚 (深月フェリシア / Mitsuki Felicia)"><br>深月<br>菲莉希亚★</label>
				<label class="girlbox umeColor" data-kana="たまき うい"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="環うい" value="环忧 (環うい / Tamaki Ui)"><br>环忧★</label>
				<label class="girlbox umeColor" data-kana="さとみ とうか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="里見灯花" value="里见灯花 (里見灯花 / Satomi Touka)"><br>里见灯花★</label>
				<label class="girlbox umeColor" data-kana="ひいらぎ ねむ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="柊ねむ" value="柊音梦 (柊ねむ / Hiiragi Nemu)"><br>柊音梦★</label>
				<label class="girlbox umeColor" data-kana="まんねんざくらのうわさ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="万年桜のウワサ" value="万年樱之谣 (万年桜のウワサ / Eternal Sakura)"><br>万年樱之<br>谣★</label>
				<label class="girlbox umeColor" data-kana="あずさ みふゆ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="梓みふゆ" value="梓美冬 (梓みふゆ / Azusa Mifuyu)"><br>梓美冬★</label>
				<label class="girlbox umeColor" data-kana="あまね つくよ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="天音月夜" value="天音月夜 (天音月夜 / Amane Tsukuyo)"><br>天音月夜★</label>
				<label class="girlbox umeColor" data-kana="あまね つかさ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="天音月咲" value="天音月咲 (天音月咲 / Amane Tsukasa)"><br>天音月咲★</label>
				<label class="girlbox umeColor" data-kana="ありな ぐれい"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="アリナ・グレイ" value="阿莉娜·格雷 (アリナ・グレイ / Alina Gray)"><br>阿莉娜·<br>格雷★</label>
				<label class="girlbox umeColor" data-kana="みその かりん"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="御園かりん" value="御园花凛 (御園かりん / Misono Karin)"><br>御园花凛★</label>
				<label class="girlbox umeColor" data-kana="みなみ れな"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="水波レナ" value="水波玲奈 (水波レナ / Minami Rena)"><br>水波玲奈★</label>
				<label class="girlbox umeColor" data-kana="とがめ ももこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="十咎ももこ" value="十咎桃子 (十咎ももこ / Togame Momoko)"><br>十咎桃子★</label>
				<label class="girlbox umeColor" data-kana="あきの かえで"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="秋野かえで" value="秋野枫 (秋野かえで / Akino Kaede)"><br>秋野枫★</label>
				<label class="girlbox umeColor" data-kana="いずみ かなぎ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="和泉十七夜" value="和泉十七夜 (和泉十七夜 / Izumi Kanagi)"><br>和泉十七夜★</label>
				<label class="girlbox umeColor" data-kana="やくも みたま"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="八雲みたま" value="八云御魂 (八雲みたま / Yakumo Mitama)"><br>八云<br>御魂★</label>
				<label class="girlbox umeColor" data-kana="みやこ ひなの"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="都ひなの" value="都雏乃 (都ひなの / Miyako Hinano)"><br>都雏乃★</label>
				<label class="girlbox umeColor" data-kana="みどり りょう"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="観鳥令" value="观鸟令 (観鳥令 / Midori Ryo)"><br>观鸟令★</label>
				<label class="girlbox umeColor" data-kana="まきの いくみ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="牧野郁美" value="牧野郁美 (牧野郁美 / Makino Ikumi)"><br>牧野郁美★</label>
				<label class="girlbox umeColor" data-kana="たつき あすか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="竜城明日香" value="龙城明日香 (竜城明日香 / Tatsuki Asuka)"><br>龙城明日香★</label>
				<label class="girlbox umeColor" data-kana="みなぎ ささら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="美凪ささら" value="美凪纱纱罗 (美凪ささら / Minagi Sasara)"><br>美凪纱纱罗★</label>
				<label class="girlbox umeColor" data-kana="くろえ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="黒江" value="黑江 (黒江 / Kuroe)"><br>黑江★</label>

				<label class="girlbox otherColor leftm" data-kana="さとり かごめ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="佐鳥かごめ" value="佐鸟笼目 (佐鳥かごめ / Satori Kagome)"><br>佐鸟笼目★</label>
				<label class="girlbox otherColor" data-kana="ひむろ らび"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="氷室ラビ" value="冰室拉比 (氷室ラビ / Himuro Lavi)"><br>冰室拉比★</label>
				<label class="girlbox otherColor" data-kana="さとみ なゆた"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="里見那由他" value="里见那由他 (里見那由他 / Satomi Nayuta)"><br>里见那由他★</label>
				<label class="girlbox otherColor" data-kana="やくも みかげ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="八雲みかげ" value="八云御影 (八雲みかげ / Yakumo Mikage)"><br>八云御影★</label>

				<label class="girlbox PMHQColor leftm" data-kana="ときめ しずか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="時女静香" value="时女静香 (時女静香 / Tokime Shizuka)"><br>时女静香★</label>
				<label class="girlbox PMHQColor" data-kana="ひろえ ちはる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="広江ちはる" value="广江千春 (広江ちはる / Hiroe Chiharu)"><br>广江千春★</label>
				<label class="girlbox PMHQColor" data-kana="とき すなお"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="土岐すなお" value="土岐沙绪 (土岐すなお / Toki Sunao)"><br>土岐沙绪★</label>
				<label class="girlbox PMHQColor" data-kana="あおば ちか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="青葉ちか" value="青叶知花 (青葉ちか / Aoba Chika)"><br>青叶知花★</label>
				<label class="girlbox PMHQColor" data-kana="なつ りょうこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="南津涼子" value="南津凉子 (南津涼子 / Natsu Ryoko)"><br>南津凉子★</label>
				<label class="girlbox PMHQColor" data-kana="みうら あさひ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="三浦旭" value="三浦旭 (三浦旭 / Miura Asahi)"><br>三浦旭★</label>

				<label class="girlbox umeOtherColor leftm" data-kana="くれは ゆな"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="紅晴結菜" value="红晴结菜 (紅晴結菜 / Kureha Yuna)"><br>红晴结菜★</label>
				<label class="girlbox umeOtherColor" data-kana="きらり ひかる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="煌里ひかる" value="煌里光 (煌里ひかる / Kirari Hikaru)"><br>煌里光★</label>
				<label class="girlbox umeOtherColor" data-kana="かさね あお"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="笠音アオ" value="笠音青 (笠音アオ / Kasane Ao)"><br>笠音青★</label>
				<label class="girlbox umeOtherColor" data-kana="おおば じゅり"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="大庭樹里" value="大庭树里 (大庭樹里 / Oba Juri)"><br>大庭树里★</label>
				<label class="girlbox umeOtherColor" data-kana="すずか さくや"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="鈴鹿さくや" value="铃鹿朔夜 (鈴鹿さくや / Suzuka Sakuya)"><br>铃鹿朔夜★</label>
				<label class="girlbox umeOtherColor" data-kana="ちず らんか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="智珠らんか" value="智珠兰华 (智珠らんか / Chizu Ranka)"><br>智珠兰华★</label>
				<label class="girlbox umeOtherColor" data-kana="ゆめ うらら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="有愛うらら" value="有爱丽 (有愛うらら / Yume Urara)"><br>有爱丽★</label>
				<label class="girlbox umeOtherColor" data-kana="いなみ みつる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="伊並満" value="伊并满 (伊並満 / Inami Mitsuru)"><br>伊并满★</label>

				<label class="girlbox PMHQotherColor leftm" data-kana="あいか ひめな"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="藍家ひめな" value="蓝家姬奈 (藍家ひめな / Aika Himena)"><br>蓝家姬奈★</label>
				<label class="girlbox PMHQotherColor" data-kana="みやび しぐれ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="宮尾時雨" value="宫尾时雨 (宮尾時雨 / Miyabi Shigure)"><br>宫尾时雨★</label>
				<label class="girlbox PMHQotherColor" data-kana="あずみ はぐむ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="安積はぐむ" value="安积育梦 (安積はぐむ / Azumi Hagumu)"><br>安积育梦★</label>
				<label class="girlbox PMHQotherColor" data-kana="かぐら さん"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="神楽燦" value="神乐灿 (神楽燦 / Kagura San)"><br>神乐灿★</label>
				<label class="girlbox PMHQotherColor" data-kana="ゆかり みゆり"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="遊狩ミユリ" value="游狩美由利 (遊狩ミユリ / Yukari Miyuri)"><br>游狩美由利★</label>
				<label class="girlbox PMHQotherColor" data-kana="くるす あれくさんどら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="栗栖アレクサンドラ" value="栗栖亚历山德拉 (栗栖アレクサンドラ / Kurisu Alexandra)"><br>栗栖亚历山德拉★</label>
				<label class="girlbox PMHQotherColor" data-kana="かざり じゅん"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="飾利潤" value="饰利润 (飾利潤 / Kazari Jun)"><br>饰利润★</label>
				<label class="girlbox PMHQotherColor" data-kana="みわ みつね"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="三輪みつね" value="三轮光音 (三輪みつね / Miwa Mitsune)"><br>三轮光音★</label>

				<label class="girlbox otherColor2 leftm" data-kana="さわ すだち"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="佐和月出里" value="佐和月出里 (佐和月出里 / Sawa Sudachi)"><br>佐和月出里★</label>
				<label class="girlbox otherColor2" data-kana="ささめ よづる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="篠目ヨヅル" value="篠目夜鹤 (篠目ヨヅル / Shinome Yozuru)"><br>篠目夜鹤★</label>
				<label class="girlbox otherColor2" data-kana="りゔぃあ めでぃろす"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="リヴィア・メディロス" value="莉薇娅·梅黛洛斯 (リヴィア・メディロス / Livia Medeiros)"><br>莉薇娅·梅黛洛斯★</label>

				<label class="girlbox otherotherColor leftm" data-kana="かなめ まどか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="鹿目まどか" value="鹿目圆 (鹿目まどか / Kaname Madoka)"><br>鹿目<br>圆★</label>
				<label class="girlbox otherotherColor" data-kana="あけみ ほむら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="暁美ほむら" value="晓美焰 (暁美ほむら / Akemi Homura)"><br>晓美<br>焰★</label>
				<label class="girlbox otherotherColor" data-kana="あけみ ほむら めがね"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="暁美ほむら(眼鏡ver)" value="晓美焰-眼镜ver (暁美ほむら(眼鏡ver) / Akemi Homura (Glasses ver))"><br>晓美焰<br>-眼镜ver★</label>
				<label class="girlbox otherotherColor" data-kana="みき さやか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="美樹さやか" value="美树沙耶香 (美樹さやか / Miki Sayaka)"><br>美树沙耶香★</label>
				<label class="girlbox otherotherColor" data-kana="ともえ まみ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="巴マミ" value="巴麻美 (巴マミ / Tomoe Mami)"><br>巴麻美★</label>
				<label class="girlbox otherotherColor" data-kana="さくら きょうこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="佐倉杏子" value="佐仓杏子 (佐倉杏子 / Sakura Kyoko)"><br>佐仓杏子★</label>
				<label class="girlbox otherotherColor" data-kana="ももえ なぎさ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="百江なぎさ" value="百江渚 (百江なぎさ / Momoe Nagisa)"><br>百江渚★</label>
				<label class="girlbox unimpColor" data-kana="あき まばゆ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="愛生まばゆ" value="爱生眩 (愛生まばゆ / Aki Mabayu)"><br>爱生眩</label>
				<label class="girlbox unimpColor" data-kana="あき さきえ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="愛生咲笑" value="爱生咲笑 (愛生咲笑 / Aki Sakie)"><br>爱生咲笑</label>
				<label class="girlbox unimpColor" data-kana="まばゆのはは"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="まばゆの母" value="眩的母亲 (まばゆの母 / Mrs. Aki)"><br>眩的母亲</label>
				<label class="girlbox otherotherColor" data-kana="しづき ひとみ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="志筑仁美" value="志筑仁美 (志筑仁美 / Shizuki Hitomi)"><br>志筑仁美</label>
				<label class="girlbox otherotherColor" data-kana="かみじょう きょうすけ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="上条恭介" value="上条恭介 (上条恭介 / Kamijo Kyosuke)"><br>上条恭介</label>
				<label class="girlbox otherotherColor" data-kana="かなめ じゅんこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="鹿目詢子" value="鹿目询子 (鹿目詢子 / Kaname Junko)"><br>鹿目询子</label>
				<label class="girlbox otherotherColor" data-kana="さおとめ せんせい"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="早乙女先生" value="早乙女和子 (早乙女先生 / Saotome Kazuko)"><br>早乙女老师</label>

				<label class="girlbox umeOtherColor leftm" data-kana="やよい かのこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="矢宵かのこ" value="矢宵鹿乃子 (矢宵かのこ / Yayoi Kanoko)"><br>矢宵鹿乃子★</label>
				<label class="girlbox umeOtherColor" data-kana="くるみ まなか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="胡桃まなか" value="胡桃爱香 (胡桃まなか / Kurumi Manaka)"><br>胡桃爱香★</label>
				<label class="girlbox umeOtherColor" data-kana="わかな つむぎ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="若菜つむぎ" value="若菜纺 (若菜つむぎ / Wakana Tsumugi)"><br>若菜纺★</label>
				<label class="girlbox umeOtherColor" data-kana="あみ りあ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="阿見莉愛" value="阿见莉爱 (阿見莉愛 / Ami Ria)"><br>阿见莉爱★</label>
				<label class="girlbox umeOtherColor" data-kana="こづえ まゆ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="梢麻友" value="梢麻友 (梢麻友 / Kozue Mayu)"><br>梢麻友★</label>
				<label class="girlbox umeOtherColor" data-kana="ふみの さゆき"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="史乃沙優希" value="史乃沙优希 (史乃沙優希 / Fumino Sayuki)"><br>史乃沙优希★</label>
				<label class="girlbox umeOtherColor" data-kana="ななせ ゆきか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="七瀬ゆきか" value="七濑幸佳 (七瀬ゆきか / Nanase Yukika)"><br>七濑幸佳★</label>

				<label class="girlbox otherColor" data-kana="ゆずき ほとり"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="柚希ほとり" value="柚希步鸟 (柚希ほとり / Yuzuki Hotori)"><br>柚希步鸟★</label>
				<label class="girlbox otherColor" data-kana="ゆずき りおん"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="柚希りおん" value="柚希理音 (柚希りおん / Yuzuki Rion)"><br>柚希理音★</label>
				<label class="girlbox otherColor" data-kana="かはる ゆうな"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="香春ゆうな" value="香春优奈 (香春ゆうな / Kaharu Yuuna)"><br>香春优奈★</label>
				<label class="girlbox otherColor" data-kana="いりな くしゅ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="入名クシュ" value="入名库什 (入名クシュ / Kush Irina)"><br>入名库什★</label>

				<label class="girlbox umeColor" data-kana="めぐみ もか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="恵萌花" value="惠萌花 (恵萌花 / Megumi Moka)"><br>惠萌花★</label>
				<label class="girlbox umeColor" data-kana="ゆら ほたる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="由良蛍" value="由良萤 (由良蛍 / Yura Hotaru)"><br>由良萤★</label>
				<label class="girlbox umeColor" data-kana="まい あかり"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="真井あかり" value="真井灯 (真井あかり / Mai Akari)"><br>真井灯★</label>

				<label class="girlbox PMHQotherColor" data-kana="ひびき めぐる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="枇々木めぐる" value="枇枇木巡 (枇々木めぐる / Hibiki Meguru)"><br>枇枇木巡★</label>
				<label class="girlbox PMHQotherColor" data-kana="ゆき まりあ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="由貴真里愛" value="由贵真里爱 (由貴真里愛 / Yuki Maria)"><br>由贵真里爱★</label>
				<label class="girlbox PMHQotherColor" data-kana="きりの さえ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="桐野紗枝" value="桐野纱枝 (桐野紗枝 / Kirino Sae)"><br>桐野纱枝★</label>

				<label class="girlbox umeColor" data-kana="えり あいみ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="江利あいみ" value="江利爱实 (江利あいみ / Eri Aimi)"><br>江利爱实★</label>
				<label class="girlbox umeColor" data-kana="うつほ なつき"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="空穂夏希" value="空穗夏希 (空穂夏希 / Utsuho Natsuki)"><br>空穗夏希★</label>
				<label class="girlbox umeColor" data-kana="あわね こころ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="粟根こころ" value="粟根心 (粟根こころ / Awane Kokoro)"><br>粟根心★</label>
				<label class="girlbox umeColor" id="masara" data-kana="かがみ まさら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="加賀見まさら" value="加贺见真良 (加賀見まさら / Kagami Masara)"><br>加贺见真良★</label>
				<label class="girlbox umeColor" data-kana="あやの りか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="綾野梨花" value="绫野梨花 (綾野梨花 / Ayano Rika)"><br>绫野梨花★</label>
				<label class="girlbox umeColor" data-kana="いすず れん"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="五十鈴れん" value="五十铃怜 (五十鈴れん / Isuzu Ren)"><br>五十铃怜★</label>
				<label class="girlbox umeColor" data-kana="まりこ あやか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="毬子あやか" value="毬子亚弥华 (毬子あやか / Mariko Ayaka)"><br>毬子亚弥华★</label>
				<label class="girlbox umeColor" data-kana="ほずみ しずく"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="保澄雫" value="保澄雫 (保澄雫 / Hozumi Shizuku)"><br>保澄雫★</label>

				<label class="girlbox umeColor" data-kana="きさき えみり"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="木崎衣美里" value="木崎衣美里 (木崎衣美里 / Kisaki Emiri)"><br>木崎衣美里★</label>
				<label class="girlbox umeColor" data-kana="はるな このみ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="春名このみ" value="春名木乃美 (春名このみ / Haruna Konomi)"><br>春名木乃美★</label>
				<label class="girlbox umeColor" data-kana="まお ひみか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="眞尾ひみか" value="真尾日美香 (眞尾ひみか / Mao Himika)"><br>真尾日美香★</label>
				<label class="girlbox umeColor" data-kana="ちあき りこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="千秋理子" value="千秋理子 (千秋理子 / Chiaki Riko)"><br>千秋理子★</label>
				<label class="girlbox umeColor" id="ash" data-kana="あしゅりー ていらー"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="アシュリー・テイラー" value="阿什莉·泰勒 (アシュリー・テイラー / Ashley Taylor)"><br>阿什莉·泰勒★</label>

				<label class="girlbox otherColor" data-kana="こまち みくら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="古町みくら" value="古町美仓 (古町みくら / Komachi Mikura)"><br>古町美仓★</label>
				<label class="girlbox otherColor" data-kana="みほの せいら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="三穂野せいら" value="三穗野星罗 (三穂野せいら / Mihono Seira)"><br>三穗野星罗★</label>
				<label class="girlbox otherColor" data-kana="きら てまり"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="吉良てまり" value="吉良手鞠 (吉良てまり / Kira Temari)"><br>吉良手鞠★</label>
				<label class="girlbox otherColor" data-kana="みずき るい"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="水樹塁" value="水树垒 (水樹塁 / Mizuki Rui)"><br>水树垒★</label>

				<label class="girlbox PMHQColor" data-kana="ときわ ななか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="常盤ななか" value="常盘七香 (常盤ななか / Tokiwa Nanaka)"><br>常盘七香★</label>
				<label class="girlbox PMHQColor" data-kana="しのぶ あきら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="志伸あきら" value="志伸晶 (志伸あきら / Shinobu Akira)"><br>志伸晶★</label>
				<label class="girlbox PMHQColor" data-kana="なつめ かこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="夏目かこ" value="夏目佳子 (夏目かこ / Natsume Kako)"><br>夏目佳子★</label>
				<label class="girlbox PMHQColor" data-kana="ちゅん めいゆい"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="純美雨" value="纯美雨 (純美雨 / Chun Meiyui)"><br>纯美雨★</label>

				<label class="girlbox PMHQotherColor" data-kana="いぶき れいら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="伊吹れいら" value="伊吹丽良 (伊吹れいら / Ibuki Leila)"><br>伊吹丽良★</label>
				<label class="girlbox PMHQotherColor" data-kana="くみ せいか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="桑水せいか" value="桑水清佳 (桑水せいか / Kumi Seika)"><br>桑水清佳★</label>
				<label class="girlbox PMHQotherColor" data-kana="あいの みと"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="相野みと" value="相野未都 (相野みと / Aino Mito)"><br>相野未都★</label>

				<label class="girlbox PMHQotherColor" data-kana="しずみ このは"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="静海このは" value="静海木叶 (静海このは / Shizumi Konoha)"><br>静海木叶★</label>
				<label class="girlbox PMHQotherColor" data-kana="ゆさ はづき"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="遊佐葉月" value="游佐叶月 (遊佐葉月 / Yusa Hazuki)"><br>游佐叶月★</label>
				<label class="girlbox PMHQotherColor" data-kana="みくり あやめ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="三栗あやめ" value="三栗菖蒲 (三栗あやめ / Mikuri Ayame)"><br>三栗菖蒲★</label>

				<label class="girlbox umeColor" data-kana="さらさ はんな"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="更紗帆奈" value="更纱帆奈 (更紗帆奈 / Sarasa Hanna)"><br>更纱帆奈★</label>
				<label class="girlbox umeColor" data-kana="せな みこと"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="瀬奈みこと" value="濑奈命 (瀬奈みこと / Sena Mikoto)"><br>濑奈命★</label>

				<label class="girlbox otherColor" data-kana="ゆぅ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ユゥ" value="夕 (ユゥ / Yu)"><br>夕★</label>
				<label class="girlbox otherColor" data-kana="しぃ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="シィ" value="椎 (シィ / Shi)"><br>椎★</label>

				<label class="girlbox otherColor2" data-kana="ゆきの かなえ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="雪野かなえ" value="雪野加奈惠 (雪野かなえ / Yukino Kanae)"><br>雪野加奈惠★</label>
				<label class="girlbox otherColor2" data-kana="あんな める"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="安名メル" value="安名梅露 (安名メル / Anna Meru)"><br>安名梅露★</label>

				<!-- その他キャラ -->
				<label class="girlbox mobColor" data-kana="くろ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="黒" value="黑 (黒 / Kuro)"><br>黑★</label>
				<label class="girlbox mobColor" data-kana="くろ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="くろ" value="小黑 (くろ / Kuro)"><br>小黑★</label>

				<!-- ヒストリアキャラ -->
				<label class="girlbox hisColor leftm" data-kana="みずな つゆ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="水名露" value="水名露 (水名露 / Mizuna Tsuyu)"><br>水名露★</label>
				<label class="girlbox hisColor" data-kana="ちづる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="千鶴" value="千鹤 (千鶴 / Chizuru)"><br>千鹤★</label>
				<label class="girlbox hisColor" data-kana="みずなまさつな"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="水名正綱" value="水名正纲 (水名正綱 / Masatsuna Mizuna)"><br>水名正纲</label>
				<label class="girlbox hisColor" data-kana="げんうん"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="玄雲" value="玄云 (玄雲 / Gen'un)"><br>玄云</label>
				<label class="girlbox hisColor" data-kana="ばんしゅ さんえもん"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="万守山右衛門" value="万守山右卫门 (万守山右衛門 / San'emon Banshu)"><br>万守山右卫门</label>
				<label class="girlbox hisColor" data-kana="えぼにー"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="エボニー" value="埃博妮 (エボニー / Ebony)"><br>埃博妮★</label>
				<label class="girlbox hisColor" data-kana="くれおぱとら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="クレオパトラ" value="克利奥帕特拉 (クレオパトラ / Cleopatra)"><br>克利奥帕特拉</label>
				<label class="girlbox hisColor" data-kana="ちょうろう"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="長老" value="长老 (長老 / Met Clan Elder)"><br>长老</label>
				<label class="girlbox hisColor" data-kana="おるが"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="オルガ" value="奥尔加 (オルガ / Olga)"><br>奥尔加★</label>
				<label class="girlbox hisColor" data-kana="がんひると"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ガンヒルト" value="冈希尔德 (ガンヒルト / Gunhild)"><br>冈希尔德★</label>
				<label class="girlbox hisColor" data-kana="えっぺ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="エッペ" value="埃佩 (エッペ / Ebbe)"><br>埃佩</label>
				<label class="girlbox hisColor" data-kana="はーらる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ハーラル" value="哈拉尔 (ハーラル / Harald Hardrada)"><br>哈拉尔</label>
				<label class="girlbox hisColor" data-kana="へるか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ヘルカ" value="赫露迦 (ヘルカ / Heruka)"><br>赫露迦★</label>
				<label class="girlbox hisColor" data-kana="どるま"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ドルマ" value="卓玛 (ドルマ / Dolma)"><br>卓玛</label>
				<label class="girlbox hisColor" data-kana="どろあだい"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ドロアダイ" value="朵啰阿歹 (ドロアダイ / Dolo'adai)"><br>朵啰阿歹</label>
				<label class="girlbox hisColor" data-kana="とよ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="トヨ" value="台与 (トヨ / Toyo)"><br>台与★</label>
				<label class="girlbox hisColor" data-kana="ひみこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="卑弥呼" value="卑弥呼 (卑弥呼 / Himiko)"><br>卑弥呼</label>
				<label class="girlbox hisColor" data-kana="あまりゅりす"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="アマリュリス" value="阿玛琉莉丝 (アマリュリス / Amaryllis)"><br>阿玛琉莉丝★</label>
				<label class="girlbox hisColor" data-kana="こるねりあ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="コルネリア" value="科尔内利娅 (コルネリア / Cornelia)"><br>科尔内利娅</label>
				<label class="girlbox hisColor" data-kana="ゆにあ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ユニア" value="尤尼娅 (ユニア / Junia)"><br>尤尼娅</label>

				<!-- ここから外伝キャラ -->
				<label class="girlbox gaidenColor leftm" data-kana="みくに おりこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="美国織莉子" value="美国织莉子 (美国織莉子 / Mikuni Oriko)"><br>美国织莉子★</label>
				<label class="girlbox gaidenColor" data-kana="くれ きりか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="呉キリカ" value="吴纪里香 (呉キリカ / Kure Kirika)"><br>吴纪里香★</label>
				<label class="girlbox gaidenColor" data-kana="ちとせ ゆま"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="千歳ゆま" value="千岁由麻 (千歳ゆま / Chitose Yuma)"><br>千岁由麻★</label>
				<label class="girlbox gaidenColor" data-kana="あさこ こまき"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="浅古小巻" value="浅古小卷 (浅古小巻 / Asako Komaki)"><br>浅古小卷</label>
				<label class="girlbox gaidenColor" data-kana="あさこ こいと"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="浅古小糸" value="浅古小糸 (浅古小糸 / Asako Koito)"><br>浅古小糸</label>
				<label class="girlbox gaidenColor" data-kana="ゆうき ささ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="優木沙々" value="优木沙沙 (優木沙々 / Yuuki Sasa)"><br>优木沙沙</label>
				<label class="girlbox gaidenColor" data-kana="なめかた あきら"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="行方晶" value="行方晶 (行方晶 / Namekata Akira)"><br>行方晶</label>
				<label class="girlbox gaidenColor" data-kana="すずな みお"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="煤名美緒" value="煤名美绪 (煤名美緒 / Suzuna Mio)"><br>煤名美绪</label>
				<label class="girlbox gaidenColor" data-kana="さき みやこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="佐木京" value="佐木京 (佐木京 / Saki Miyako)"><br>佐木京</label>
				<label class="girlbox gaidenColor" data-kana="ひとみ りな"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="人見リナ" value="人见里奈 (人見リナ / Hitomi Lina)"><br>人见里奈</label>
				<label class="girlbox gaidenColor" data-kana="あかね まい"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="朱音麻衣" value="朱音麻衣 (朱音麻衣 / Akane Mai)"><br>朱音麻衣</label>

				<label class="girlbox gaidenColor leftm" data-kana="かずみ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="かずみ" value="和美 (かずみ / Kazumi)"><br>和美★</label>
				<label class="girlbox gaidenColor" data-kana="みさき うみか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="御崎海香" value="御崎海香 (御崎海香 / Misaki Umika)"><br>御崎海香★</label>
				<label class="girlbox gaidenColor" data-kana="まき かおる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="牧カオル" value="牧薰 (牧カオル / Maki Kaoru)"><br>牧薰★</label>
				<label class="girlbox gaidenColor" data-kana="かずさ みちる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="和紗ミチル" value="和纱美千瑠 (和紗ミチル / Kazusa Michiru)"><br>和纱美千瑠</label>
				<label class="girlbox gaidenColor" data-kana="あさみ さき"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="浅海サキ" value="浅海早纪 (浅海サキ / Asami Saki)"><br>浅海早纪</label>
				<label class="girlbox gaidenColor" data-kana="かんな にこ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="神那ニコ" value="神那妮可 (神那ニコ / Kanna Niko)"><br>神那妮可</label>

				<label class="girlbox gaidenColor leftm" data-kana="たると"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="タルト" value="塔鲁特 (タルト / Tart)"><br>塔鲁特★</label>
				<label class="girlbox gaidenColor" data-kana="りず"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="リズ" value="莉兹 (リズ / Riz Hawkwood)"><br>莉兹★</label>
				<label class="girlbox gaidenColor" data-kana="めりっさ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="メリッサ" value="梅丽莎 (メリッサ / Melissa de Vignolles)"><br>梅丽莎★</label>
				<label class="girlbox gaidenColor" data-kana="えりざ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="エリザ" value="爱丽莎 (エリザ / Eliza Celjska)"><br>爱丽莎★</label>
				<label class="girlbox gaidenColor" data-kana="ぺれねる"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ペレネル" value="佩尔内勒 (ペレネル / Pernelle Flamel)"><br>佩尔内勒★</label>
				<label class="girlbox gaidenColor" data-kana="みぬぅ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ミヌゥ" value="米诺 (ミヌゥ / Minou)"><br>米诺★</label>
				<label class="girlbox gaidenColor" data-kana="こるぼー"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="コルボー" value="可鲁波 (コルボー / Corbeau)"><br>可鲁波★</label>
				<label class="girlbox gaidenColor" data-kana="らぴぬ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ラピヌ" value="拉皮努 (ラピヌ / Lapin)"><br>拉皮努★</label>
				<label class="girlbox gaidenColor" data-kana="いざぼー"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="イザボー" value="伊莎贝拉 (イザボー / Isabeau de Bavière)"><br>伊莎贝拉★</label>

				<label class="girlbox gaidenColor leftm" data-kana="あまの すずね"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="天乃鈴音" value="天乃铃音 (天乃鈴音 / Amano Suzune)"><br>天乃铃音★</label>
				<label class="girlbox gaidenColor" data-kana="ひなた まつり"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="日向茉莉" value="日向茉莉 (日向茉莉 / Hinata Matsuri)"><br>日向茉莉★</label>
				<label class="girlbox gaidenColor" data-kana="なるみ ありさ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="成見亜里紗" value="成见亚里纱 (成見亜里紗 / Narumi Arisa)"><br>成见亚里纱★</label>
				<label class="girlbox gaidenColor" data-kana="しおん ちさと"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="詩音千里" value="诗音千里 (詩音千里 / Shion Chisato)"><br>诗音千里★</label>
				<label class="girlbox gaidenColor" data-kana="かなで はるか"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="奏遥香" value="奏遥香 (奏遥香 / Kanade Haruka)"><br>奏遥香★</label>
				<label class="girlbox gaidenColor" data-kana="みこと つばき"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="美琴椿" value="美琴椿 (美琴椿 / Mikoto Tsubaki)"><br>美琴椿★</label>
				<label class="girlbox gaidenColor" data-kana="ひなた かがり"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="日向華々莉" value="日向华华莉 (日向華々莉 / Hinata Kagari)"><br>日向华华莉</label>

				<!-- ここからコラボキャラ -->
				<label class="girlbox collaboColor leftm" data-kana="たかまち なのは"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="高町なのは" value="高町奈叶 (高町なのは / Takamachi Nanoha)"><br>高町奈叶★</label>
				<label class="girlbox collaboColor" id="fate_t" data-kana="ふぇいと てぃー はらおうん"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="フェイト・T・ハラオウン" value="菲特·T·哈拉温 (フェイト・T・ハラオウン / Fate T. Harlaown)"><br>菲特·T<br>·哈拉温★</label>
				<label class="girlbox collaboColor" data-kana="やがみ はやて"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="八神はやて" value="八神疾风 (八神はやて / Yagami Hayate)"><br>八神疾风★</label>
				<label class="girlbox collaboColor" data-kana="にしきぎ ちさと"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="錦木千束" value="锦木千束 (錦木千束 / Nishikigi Chisato)"><br>锦木千束★</label>
				<label class="girlbox collaboColor" data-kana="いのうえ たきな"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="井ノ上たきな" value="井之上泷奈 (井ノ上たきな / Inoue Takina)"><br>井之上泷奈★</label>
				<label class="girlbox collaboColor" data-kana="くるみ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="クルミ" value="胡桃 (クルミ / Kurumi)"><br>胡桃</label>

				<!-- ここから魔法少女以外 -->
				<label class="girlbox mobColor leftm" data-kana="きゅぅべえ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="キュゥべえ" value="丘比 (キュゥべえ / Kyubey)"><br>丘比★</label>
				<label class="girlbox mobColor leftm" data-kana="エーキュゥ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="A-Q" value="A-Q (A-Q / A-Q)"><br>A-Q</label>
				<label class="girlbox mobColor leftm" data-kana="なまえ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="ナマエ" value="名小姐 (ナマエ / Name)"><br>名小姐</label>

				<label class="girlbox unimpColor leftm" data-kana="さとみ たすけ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="里見太助" value="里见太助 (里見太助 / Tasuke Satomi)"><br>里见太助</label>
				<label class="girlbox unimpColor" data-kana="とうかのちち"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="灯花の父" value="灯花之父 (灯花の父 / Dr. Satomi)"><br>灯花之父</label>
				<label class="girlbox unimpColor" data-kana="いずみ そうげつ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="和泉壮月" value="和泉壮月 (和泉壮月 / Sougetsu Izumi)"><br>和泉壮月</label>
				<label class="girlbox unimpColor" data-kana="しおや はるみ"><input type="checkbox" class="MagicalChk"   ondblclick="mgirlCallNarrow(this)" name="chara" id="塩屋晴海" value="盐屋晴海 (塩屋晴海 / Harumi Shioya)"><br>盐屋晴海</label>
			</div>
		</form>
		<!-- 魔法少女复选框实现结束 -->
		<input type="button" value="重置筛选" class="ndownReset" onClick="ndownReset('call');">

		<input type="button" value="取消选择所有魔法少女" name="mgreset" class="mgreset" id="mgreset2"
			   onClick="return girlReset()">

		<input type="button" name="search" class="mgr-10 searchbtn" value="搜索" onClick="drawAndJump()">
		<!-- 魔法少女筛选文本输入实现 -->
		<input type="text" spellcheck="false" class="ndownword" name="ndownword"
			   placeholder="按假名/汉字/名字筛选。空格分隔表示OR。删除返回" id="ndownword2" oninput="mgirlNarrow('call', 'ndownword2')">

		<div class="caution">
			※拖动图标：移动图标　滚动滚轮：放大/缩小　拖动空白处：移动整个关系图<br>
			单击图标/箭头：高亮　双击图标：移动到中心并高亮<br>
			※如果未显示图标，请先“取消所有选择”，然后重新选择
		</div>

		<fieldset style="margin-bottom: 10px;">
			<legend>按属性选择魔法少女</legend>
			<form id="at_form">
				<label class="at">
					<input type="radio" class="at_and_or" name="at_and_or" value="AND" checked="checked"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" required>AND
				</label>
				<label class="at">
					<input type="radio" class="at_and_or" name="at_and_or" value="OR"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }">OR
				</label>
				<input type="button" id="at_reset" value="重置属性" onClick="mgirlShReset('call');"><br>

				<!--魔法少女属性一览 -->
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="まどマギ">魔法少女小圆
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="マギレコ">魔法纪录
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="まどドラ">小圆前辈
				</label>

				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="小学生">小学生
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="中1">初一
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="中2">初二
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="中3">初三
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="中学生">初中生
				</label>

				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="高1">高一
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="高2">高二
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="高3">高三
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="高校生">高中生
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="その他">其他
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="学年不明">年级不详
				</label>

				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="神浜市立大附属">神滨市立大学附属学校
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="水名女学園">水名女子学园
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="参京院教育学園">参京院教育学园
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="栄総合学園">荣综合学园
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="中央学園">中央学园
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="南凪自由学園">南凪自由学园
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="工匠学舎">工匠学舍
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="大東学院">大东学院
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="聖リリアンナ学園">圣莉莉安娜学园
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="神浜未来アカデミー">神滨未来学院
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="湯の花国際中学・高等学校">汤之花国际中学・高等学校
				</label>

				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="松宮市立第一中学校">松宫市立第一中学
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="霧峰村立霧峰中学校">雾峰村立雾峰中学
				</label>

				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="虎屋町学園">虎屋町学园
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="竜ケ崎学院">龙崎学院
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="蛇の宮中学・高等学校">蛇之宫中学・高等学校
				</label>

				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="宝崎順心学園">宝崎顺心学园
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="宝崎市立光塚中等教育学校">宝崎市立光冢中等教育学校
				</label>

				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="見滝原中学校">见泷原中学
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="白羽女学院">白羽女学院
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="あすなろ市立南部中学校">翌桧市立南部中学
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="茜ヶ咲中学校">茜咲中学
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="聖乙女学園">圣乙女学园
				</label>

				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="マギアユニオン">神滨魔法联盟
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="時女一族">时女一族
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="プロミストブラッド">PROMISED BLOOD
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="ネオマギウス">Neo-Magius
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="フォークロア">Folklore of 0
				</label>
				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="ピュエラケア">Puella Care
				</label>

				<label class="at">
					<input type="checkbox" class="at_attribute" name="at_attribute"
						   onchange="magicalGirlAttributeSearch('call'); if (document.querySelector('input[name=xAxisMode]:checked')?.value === 'attribute') { displayHeightChart(document.querySelector('.MagicalChk:checked') ? 'selected' : 'global'); }" value="ヒストリア">历史篇
				</label>
			</form>
		</fieldset>
		<!DOCTYPE html>
		<html>
		<head>
			<meta charset="utf-8">
			<!-- vis.jsをCDNで読み込み -->
			<script src="https://visjs.github.io/vis-network/standalone/umd/vis-network.min.js"></script>
			<!-- jqueryをCDNで読み込み -->
			<script src="https://code.jquery.com/jquery-3.6.0.min.js"
					integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

			<!-- Font AwesomeをCDNで読み込み -->
			<link href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" rel="stylesheet">

			<link rel="stylesheet" href="./css/style.css">
			<link rel="stylesheet" href="./css/table.css">
			<link rel="stylesheet" href="./css/button.css">

			<!-- 魔法少女☆まどか☆マギカ Magia Record 呼びかけ一覧 -->
			<title>魔法少女☆まどか☆マギカ Magia Record 呼びかけ一覧</title>
		</head>

		<body>
			<div id="callcate">
				<!-- 网络图显示 -->
				<div id="canvasflame">
					<div id="mynetwork"></div>
				</div>
				<!-- 【新增】身高图表容器 -->
<div id="heightChartContainer" style="display: none; width: 90%; margin: 20px auto;">
    <!-- 身高图表将由JavaScript动态生成在这里 -->
</div>
				<BR>
				画布尺寸：宽
				<input type="number" value="90" style="width:60px" id="canvasWidth">
				<select id="widthUnit">
					<option value="%" selected>%</option>
					<option value="px">px</option>
				</select> x 高 <input type="number" max="3000" style="width:60px" id="canvasHeight" value="400">px
				<input type="button" value="设置" onClick="canvasSet();">

				<a href="" id="canvasImgLink" download="">保存为图片</a>
				<BR>
				<!-- X(Twitter)分享按钮实现 -->
				<a href="https://twitter.com/share?ref_src=twsrc%5Etfw&hashtags=マギレコ,まどドラ" class="twitter-share-button"
				   data-show-count="false" data-size="large">Tweet</a>
				<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
			</div>

			<!-- 显示表格 -->
			<div id="mytable"></div>

			<!-- 显示部分结束。以下为处理用javascript等 ============================================== -->
			<script src="https://visjs.github.io/vis-network/standalone/umd/vis-network.min.js"></script>
			<!-- 读取用电子表格创建的称呼哈希文件。 -->
			<script src="./myfile/callTable.js"></script>
			<!-- 读取通用处理文件 -->
			<script src="./myfile/myCommon.js"></script>
			<!-- 读取魔法少女筛选的javascript方法 -->
			<script src="./myfile/mgirlNarrow.js"></script>
			<!-- 读取带称呼的魔法少女筛选的javascript方法 -->
			<script src="./myfile/mgirlCallNarrow.js"></script>
			<!-- 读取筛选重置的javascript方法 -->
			<script src="./myfile/ndownReset.js"></script>
			<!-- 读取角色属性配置文件(javascript对象) -->
			<script src="./myfile/charaAt.js"></script>
			<!-- 读取属性筛选的javascript方法 -->
			<script src="./myfile/mgirlAtSearch.js"></script>

			<script>
				//返回页面顶部。用jquery实现。
				$(function () {
					/** 页面顶部处理 **/
					$('#pagetop').fadeIn("slow");
					// 点击时
					$('#pagetop').click(function () {
						// 滚动到页面顶部
						$('html, body').animate({
							scrollTop: $("#callcate").offset().top
						}, "slow");
						return false;
					});
				});
			</script>

			<script>
				//前进到页面底部。用jquery实现。
				$(function () {
					/** 页面底部处理 **/
					$('#pagebtm').fadeIn("slow");
					// 点击时
					$('#pagebtm').click(function () {
						// 滚动到页面底部
						$('html, body').animate({
							scrollTop: $(document).height()
						}, "slow");
						return false;
					});
				});
			</script>

			<script>
				//前进到页面中部。用jquery实现。
				$(function () {
					/** 页面中部处理 **/
					$('#pagemdl').fadeIn("slow");
					// 点击时
					$('#pagemdl').click(drawAndJump);
				});
			</script>

			<!-- 顶部图标设置 -->
			<a id="pagetop" href="#top" class="page_top" style="display: none;">
				<i class="fa fa-arrow-circle-o-up fa-3x"></i>
			</a>
			<!-- 中部图标设置 -->
			<a id="pagemdl" href="#mdl" class="page_mdl" style="display: none;"><i class="fa fa-share-alt-square fa-3x"></i></a>
			<!-- 底部图标设置 -->
			<a id="pagebtm" href="#btm" class="page_btm" style="display: none;">
				<i class="fa fa-arrow-circle-o-down fa-3x"></i>
			</a>

<script>
//页面加载后立即禁用重置按钮。
document.getElementById("mgreset").disabled = true;
document.getElementById("mgreset2").disabled = true;

// 1. 创建一个映射表，用于将数据中的年级文本转换为HTML复选框的value值
const gradeMap = {
    '初一': '中1',
    '初二': '中2',
    '初三': '中3',
    '高一': '高1',
    '高二': '高2',
    '高三': '高3'
};

// 2. 第一次遍历：基于callTable的“学年”数据，添加精确年级和分类
for (let [longKey, value] of callTable) {
    const match = longKey.match(/\(([^/]+)/);
    if (!match || !match[1]) continue;
    const baseJapaneseName = match[1].trim();

    // 从数据中获取年级，并使用 .trim() 清理前后可能存在的空格
    const grade = value.get("学年") ? value.get("学年").trim() : null;
    
    if (grade && grade !== "-") {
        const attributesToAdd = new Set();

        // ★ 核心修正：使用映射表将 "初一" 转换为 "中1"
        if (gradeMap[grade]) {
            attributesToAdd.add(gradeMap[grade]);
        }
        
        // 添加更广泛的分类
        if (grade.startsWith('小')) {
            attributesToAdd.add('小学生');
        } else if (grade.startsWith('中') || grade.startsWith('初')) {
            attributesToAdd.add('中学生');
        } else if (grade.startsWith('高')) {
            attributesToAdd.add('高校生');
        } else if (["大1", "浪人生", "专门生", "成人?"].includes(grade)) {
             attributesToAdd.add('その他');
        } else if (grade === '?') {
            attributesToAdd.add('学年不明');
        }

        // 将这些属性添加到charaAttribute中所有匹配的角色版本上
        for (const charaAtKey of charaAttribute.keys()) {
            if (charaAtKey.startsWith(baseJapaneseName)) {
                const attrSet = charaAttribute.get(charaAtKey);
                if (attrSet) {
                    attributesToAdd.forEach(attr => attrSet.add(attr));
                }
            }
        }
    }
}

// 3. 第二次遍历：基于charaAttribute中已有的学校信息，补充“中学生”和“高中生”分类
// 这是为了确保即使callTable中没有学年信息，只要有学校信息就能被正确分类
for (let [charaName, attributes] of charaAttribute) {
    let isJuniorHigh = attributes.has("中学生");
    let isSeniorHigh = attributes.has("高校生");

    if (!isJuniorHigh || !isSeniorHigh) {
        for (const attr of attributes) {
            // 检查是否为初中
            if (!isJuniorHigh && attr.includes("中学")) {
                attributes.add("中学生");
                isJuniorHigh = true;
            }
            // 检查是否为高中（包括高等学校、学院等）
            if (!isSeniorHigh && (attr.includes("高等") || attr.includes("学院"))) {
                attributes.add("高校生");
                isSeniorHigh = true;
            }
        }
    }
}

				//通过函数调用用电子表格创建的称呼哈希文件。
				//网络用变量声明
				var nodes = [];
				var edges = [];
				var container = document.getElementById("mynetwork");
				var data = {};
				var options = {};
				var network = new vis.Network(container, data, options);

				//第二人称节点的坐标
				var otherx = document.getElementById('mynetwork').clientWidth / 1.8;
				var othery = document.getElementById('mynetwork').clientHeight / 0.9;
				//console.log(otherx);

				//边被选中时的动作
				var edgeChosen = function (values, id, selected, hovering) {
					values.color = "#ffffff";
					values.width = 4;
				};
				//边被选中时的标签设置
				var edgeLabelChosen = function (values, id, selected, hovering) {
					values.color = "#ff4500";
					values.size = 23;
					values.mod = "bold";
					values.strokeWidth = 5;
				};
				//节点被选中时的节点设置
				var nodeChosen = function (values, id, selected, hovering) {
					values.borderWidth = 10;
					values.borderColor = "#ff42a0";
				};
				//节点被选中时的标签设置
				var nodeLabelChosen = function (values, id, selected, hovering) {
					values.color = "#FFFFFF";
					values.size = 25;
					values.strokeColor = "#ff42a0";
					values.strokeWidth = 5;
				};


				//绘制网络。重置显示时也会调用。
				function draw() {

					// 创建网络
					data = {
						nodes: nodes,
						edges: edges
					};

					options = {
						physics: {
							enabled: true,
							stabilization: {
								enabled: true,
								iterations: 50000
							}
						},

						nodes: {
							physics: false,
							mass: 3,
							borderWidth: 7,
							size: 40,
							color: {
								border: "#ff82c0",
								background: "#FFFFFF"
							},
							font: {
								color: "#FFFFFF",
								strokeColor: '#ff82c0',
								size: 22,
								strokeWidth: 3
							},
							//设置节点被选中时的节点显示。
							chosen: {
								label: nodeLabelChosen,
								node: nodeChosen
							},
						},

						edges: {
							/*smooth: {
								 enabled: true,
									//type: "dynamic",
									type: "discrete",
								 //roundness: 0.5
								 //roundness: 0.5
							},*/
							//设置边被选中时的箭头和标签的动作。
							chosen: {
								label: edgeLabelChosen,
								edge: edgeChosen
							},

							selfReference: {
								size: 30
							},
							font: {
								color: "#000000",
								size: 22,
								strokeColor: "#FFFFFF",
								strokeWidth: 3
							},
							color: "#eaeaff",
							arrows: 'to',
							width: 2,
						}
					};

					//网络绘制
					network = new vis.Network(container, data, options);

					//创建网络图片链接的脚本
					network.on("afterDrawing", function (ctx) {
						var dataURL = ctx.canvas.toDataURL("image/jpeg");
						document.getElementById('canvasImgLink').href = dataURL;
					});
					makeImageName();

					//双击时的事件
					network.on("doubleClick", function (params) {
						//双击时如果节点已被选中则执行处理。
						//alert(params.nodes[0]);
						if (params.nodes[0]) {
							var cnt = 0;
							var radius = 300; //圆的半径
							var angle = 2 * Math.PI / (nodes.length - 2);
							for (var i = 0; i < nodes.length; i++) {
								if (nodes[i].id === params.nodes[0]) {
									network.moveNode(nodes[i].id, 0, 0);
								} else if (nodes[i].id === "二人称") { //第二人称节点的坐标。始终在右下角。
									network.moveNode(nodes[i].id, otherx, othery);
								} else { // 其他节点的坐标
									var nodesx = radius * Math.cos(angle * (cnt - 1));
									var nodesy = radius * Math.sin(angle * (cnt - 1));
									network.moveNode(nodes[i].id, nodesx, nodesy)
									cnt++;
								}
							}
						}
					});

				} //网络写入结束

function drawNet_Table() {

    // 1. 初始化网络和表格
    if (network) network.destroy();
    nodes = [];
    edges = [];
    network = null;
    var girltable = "<table id='girltable'><tr><th>↓称呼者 被称呼者→</th><th>第一人称</th><th>第二人称</th>";

    // 2.【核心修正】创建两个查找表，实现双向映射
    // nameToLongKeyMap: 用短中文名，查找HTML中那个完整的value值
    // nameToJsKeyMap:   用短中文名，查找callTable.js中那个带英文注释的key值
    const nameToHtmlValue = new Map();
    const nameToJsKey = new Map();
    
    // 从HTML中构建 "短中文名" -> "完整value" 的映射
    for (const checkbox of document.magicalgirl.chara) {
        const htmlValue = checkbox.value; // "真尾日美香 (眞尾ひみか / Mao Himika)"
        const match = htmlValue.match(/^(.*?)\s*\(/);
        const shortName = (match && match[1]) ? match[1].trim() : htmlValue; // "真尾日美香"
        nameToHtmlValue.set(shortName, htmlValue);
    }

    // 从callTable.js中构建 "短中文名" -> "JS key" 的映射
    for (const jsKey of callTable.keys()) {
        const match = jsKey.match(/^(.*?)\s*\(/);
        const shortName = (match && match[1]) ? match[1].trim() : jsKey; // "真尾日美香"
        nameToJsKey.set(shortName, jsKey);
    }

    // 3. 收集被选中的角色的“短中文名”
    const selectedShortNames = [];
    for (const checkbox of document.magicalgirl.chara) {
        if (checkbox.checked) {
            const htmlValue = checkbox.value;
            const match = htmlValue.match(/^(.*?)\s*\(/);
            const shortName = (match && match[1]) ? match[1].trim() : htmlValue;
            selectedShortNames.push(shortName);
        }
    }

    // 4. 处理按钮状态
    if (selectedShortNames.length > 0) {
        document.getElementById("mgreset").disabled = false;
        document.getElementById("mgreset2").disabled = false;
    } else {
        document.getElementById("mgreset").disabled = true;
        document.getElementById("mgreset2").disabled = true;
        document.getElementById('mytable').innerHTML = "";
        draw();
        return;
    }

    // 5. 添加节点和表格标题
    const DIR = "./img/png/";
    for (const shortName of selectedShortNames) {
        const htmlValue = nameToHtmlValue.get(shortName);
        const jsKey = nameToJsKey.get(shortName);
        if (!jsKey) {
            console.error("数据同步错误：在callTable.js中找不到与 '" + shortName + "' 对应的键。");
            continue;
        }
        const charaData = callTable.get(jsKey);
        if (!charaData) {
            console.error("数据源错误：使用键 '" + jsKey + "' 在callTable中找不到数据。");
            continue;
        }
        
        const girlImgURL = DIR + shortName + ".png";
        nodes.push({
            id: shortName, // 节点ID使用统一的短中文名
            shape: "circularImage",
            image: girlImgURL,
            label: htmlValue.replace(/\s*\(/, '\n(') // 标签显示HTML里最完整的信息
        });
        girltable += "<th>" + htmlValue + "</th>"; // 表格标题也用最完整的信息
    }
    girltable += "</tr>";

    // 6. 添加关系连线和表格内容
    for (const callerShortName of selectedShortNames) {
        const callerJsKey = nameToJsKey.get(callerShortName);
        if (!callerJsKey) continue;
        const callerData = callTable.get(callerJsKey);
        if (!callerData) continue;

        const callerHtmlValue = nameToHtmlValue.get(callerShortName);
        girltable += "<tr><th>" + callerHtmlValue + "</th>";
        girltable += "<td>" + (callerData.get("第一人称") || "") + "</td>";
        girltable += "<td>" + (callerData.get("二人称") || "") + "</td>";

        for (const calleeShortName of selectedShortNames) {
            if (callerShortName === calleeShortName) {
                girltable += "<td>—</td>";
                continue;
            }
            
            // 【最关键的查找】用“被称呼者的短名称”作为键，去查询称呼数据
            const callValue = callerData.get(calleeShortName); 
            
            if (callValue) {
                edges.push({ from: callerShortName, to: calleeShortName, label: callValue });
                girltable += "<td>" + callValue + "</td>";
            } else {
                girltable += "<td></td>";
            }
        }
        girltable += "</tr>";
    }
    girltable += "</table>";

    // 7. 设置节点位置和第一/二人称连线并绘制
    const radius = 300;
    const angle = 2 * Math.PI / nodes.length;
    for (let i = 0; i < nodes.length; i++) {
        nodes[i].x = radius * Math.cos(angle * i);
        nodes[i].y = radius * Math.sin(angle * i);
    }
    if (nodes.length) {
        nodes.push({ id: "二人称", shape: "circularImage", image: "./img/png/二人称.png", label: "二人称" });
        for (const shortName of selectedShortNames) {
            const jsKey = nameToJsKey.get(shortName);
            if (!jsKey) continue;
            const charaData = callTable.get(jsKey);
            if (charaData.get("第一人称")) {
                edges.push({ from: shortName, to: shortName, label: charaData.get("第一人称") });
            }
            if (charaData.get("二人称")) {
                edges.push({ from: shortName, to: "二人称", label: charaData.get("二人称") });
            }
        }
    }
    
    document.getElementById('mytable').innerHTML = girltable;
    draw();
}

				// 重置魔法少女的选择。函数
				function girlReset() {
					var checkboxes = document.getElementsByName('chara');
					for (i in checkboxes) {
						checkboxes[i].checked = false;
					}
					//也初始化网络信息。
					nodes = [];
					edges = [];
					network = null;
					draw();

					//也初始化表格。
					document.getElementById('mytable').innerHTML = "";

					//禁用按钮本身。
					document.getElementById("mgreset").disabled = true;
					document.getElementById("mgreset2").disabled = true;
				}
				//更改网络图的画布尺寸
				function canvasSet() {
					const widthValue = document.getElementById("canvasWidth").value;
					const widthUnit = document.getElementById("widthUnit").value;
					const heightValue = document.getElementById("canvasHeight").value;

					document.getElementById("mynetwork").style.width = widthValue + widthUnit;
					document.getElementById("mynetwork").style.height = heightValue + "px";

					//alert(heightValue);
				}
				function drawAndJump() {
					//写入网络和表格
					drawNet_Table();
					// 滚动到网络显示部分
					$('html, body').animate({
						scrollTop: $("#mynetwork").offset().top
					}, "slow");
					return false;
				}
				function makeImageName() {

					var filename = "Network"; //存放通过复选框选择的魔法少女名称的数组
					for (var i = 0; i < document.magicalgirl.chara.length; i++) {
						if (document.magicalgirl.chara[i].checked) {
							filename += "_" + document.magicalgirl.chara[i].value;
						}
					}
					filename += ".jpg";
					document.getElementById('canvasImgLink').download = filename;
				}
			</script>
	</div>
	<!-- Tooltip Enhancement Script -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        //页面加载时运行
        const labels = document.querySelectorAll('label.girlbox');
        
        labels.forEach(label => {
            const hiragana = label.dataset.kana; // 'さとう とうか'
            const input = label.querySelector('input.MagicalChk');
            if (!input) return;

            const valueText = input.value; // '里見灯花 (里見灯花 / Satomi Touka)'
            
            // 使用正则表达式提取罗马字符
            const romajiMatch = valueText.match(/\/\s*([a-zA-Z\s\.]+)\)/);
            
            if (hiragana && romajiMatch && romajiMatch[1]) {
                const romaji = romajiMatch[1].trim(); // 'Satomi Touka'
                // 创建新的工具提示文本（平假名+换行符+罗马字））
                const newTooltipText = `${hiragana}\n${romaji}`;
                
                // data-kana属性更新
                label.dataset.kana = newTooltipText;
            }
        });
    });
</script>

</html>
<script>
let isHeightView = false; 

// --- 主切换函数 ---
function toggleHeightView(show) {
    const networkContainer = document.getElementById('mynetwork').parentElement;
    const heightContainer = document.getElementById('heightChartContainer');
    const tableContainer = document.getElementById('mytable');
    
    isHeightView = show;

    if (isHeightView) {
        networkContainer.style.display = 'none';
        tableContainer.style.display = 'none';
        heightContainer.style.display = 'block';
    } else {
        heightContainer.style.display = 'none';
        networkContainer.style.display = 'block';
        tableContainer.style.display = 'block';
    }
}

// 在称呼搜索时，确保身高图表是隐藏的
function drawAndJump() {
    toggleHeightView(false); // 隐藏身高图
    drawNet_Table(); // 执行称呼搜索
    // 滚动到网络显示部分
    $('html, body').animate({
        scrollTop: $("#mynetwork").offset().top
    }, "slow");
    return false;
}
function syncAndDrawHeightChart(mode, dataSource) {
    mgirlShReset('call');

    const organizationValues = ['マギアユニオン', '時女一族', 'プロミストブラッド', 'ネオマギウス', 'フォークロア', 'ピュエラケア', 'ヒストリア'];
    const schoolValues = ['神浜市立大附属', '水名女学園', '参京院教育学園', '栄総合学園', '中央学園', '南凪自由学園', '工匠学舎', '大東学院', '聖リリアンナ学園', '神浜未来アカデミー', '湯の花国際中学・高等学校', '松宮市立第一中学校', '霧峰村立霧峰中学校', '虎屋町学園', '竜ケ崎学院', '蛇の宮中学・高等学校', '宝崎順心学園', '宝崎市立光塚中等教育学校', '見滝原中学校', '白羽女学院', 'あすなろ市立南部中学校', '茜ヶ咲中学校', '聖乙女学園', 'その他学校'];
    const gradeValues = ['小学生', '中1', '中2', '中3', '中学生', '高1', '高2', '高3', '高校生', 'その他', '学年不明'];

    let valuesToSelect = [];
    let targetMode = mode; 

    switch (mode) {
        case 'organization':
            valuesToSelect = organizationValues;
            targetMode = 'attribute'; 
            break;
        case 'school':
            valuesToSelect = schoolValues;
            targetMode = 'attribute'; 
            break;
        case 'grade':
            valuesToSelect = gradeValues;
            targetMode = 'attribute'; 
            break;
    }

    if (valuesToSelect.length > 0) {
        const allAttributeCheckboxes = document.querySelectorAll('#at_form input[type="checkbox"]');
        allAttributeCheckboxes.forEach(cb => {
            if (valuesToSelect.includes(cb.value)) {
                cb.checked = true;
            }
        });
    }

    displayHeightChart(dataSource, targetMode);
}
// ==========================================================
// 新增：属性字典 (将搜索key映射到中文显示名)
// ==========================================================
const attributeDictionary = {
    '学校': new Map([
        ['神浜市立大附属', '神滨市立大学附属学校'], ['水名女学園', '水名女子学园'], ['参京院教育学園', '参京院教育学园'],
        ['栄総合学園', '荣综合学园'], ['中央学園', '中央学园'], ['南凪自由学園', '南凪自由学园'],
        ['工匠学舎', '工匠学舍'], ['大東学院', '大东学院'], ['聖リリアンナ学園', '圣莉莉安娜学园'],
        ['神浜未来アカデミー', '神滨未来学院'], ['湯の花国際中学・高等学校', '汤之花国际中学・高等学校'],
        ['松宮市立第一中学校', '松宫市立第一中学'], ['霧峰村立霧峰中学校', '雾峰村立雾峰中学'],
        ['虎屋町学園', '虎屋町学园'], ['竜ケ崎学院', '龙崎学院'], ['蛇の宮中学・高等学校', '蛇之宫中学・高等学校'],
        ['宝崎順心学園', '宝崎顺心学园'], ['宝崎市立光塚中等教育学校', '宝崎市立光冢中等教育学校'],
        ['見滝原中学校', '见泷原中学'], ['白羽女学院', '白羽女学院'], ['あすなろ市立南部中学校', '翌桧市立南部中学'],
        ['茜ヶ咲中学校', '茜咲中学'], ['聖乙女学園', '圣乙女学园']
    ]),
    '组织': new Map([
        ['マギアユニオン', '神滨魔法联盟'], ['時女一族', '时女一族'],
        ['プロミストブラッド', 'PROMISED BLOOD'], ['ネオマギウス', 'Neo-Magius'],
        ['フォークロア', 'Folklore of 0'], ['ピュエラケア', 'Puella Care'],
        ['ヒストリア', '历史篇']
    ])
};
function displayHeightChart(dataSource, mode) {
    toggleHeightView(true);
    const container = document.getElementById('heightChartContainer');

    let sourceDataKeys = [];
    if (dataSource === 'selected') {
        const selectedCheckboxes = document.querySelectorAll('.MagicalChk:checked');
        if (selectedCheckboxes.length === 0) {
            container.innerHTML = '<h3>请先在上方勾选角色，再进行“身高搜索 (选中)”</h3>';
            return;
        }
        selectedCheckboxes.forEach(cb => sourceDataKeys.push(cb.value));
    } else {
        sourceDataKeys = Array.from(callTable.keys());
    }

    const savedXAxisMode = mode || document.querySelector('input[name="xAxisMode"]:checked')?.value || 'age';
    // 尝试获取视图模式，如果不存在（第一次加载），则默认为 'scatter'
    const currentViewMode = document.querySelector('input[name="viewMode"]:checked')?.value || 'scatter';

    container.innerHTML = `
        <h3>身高分布图</h3>
        <div id="chartControlPanel">
            <strong>显示模式:</strong>
            <label><input type="radio" name="viewMode" value="scatter" onchange="displayHeightChart('${dataSource}', '${savedXAxisMode}')" ${currentViewMode === 'scatter' ? 'checked' : ''}> 散点图</label>
            <label><input type="radio" name="viewMode" value="bar" onchange="displayHeightChart('${dataSource}', '${savedXAxisMode}')" ${currentViewMode === 'bar' ? 'checked' : ''}> 条形图 (平均身高)</label>
            <hr>
            <strong>X轴分类:</strong>
            <label><input type="radio" name="xAxisMode" value="age" onchange="syncAndDrawHeightChart('age', '${dataSource}')" ${savedXAxisMode === 'age' ? 'checked' : ''}> 年龄</label>
            <label><input type="radio" name="xAxisMode" value="grade" onchange="syncAndDrawHeightChart('grade', '${dataSource}')" ${savedXAxisMode === 'grade' ? 'checked' : ''}> 学年</label>
            <label><input type="radio" name="xAxisMode" value="school" onchange="syncAndDrawHeightChart('school', '${dataSource}')" ${savedXAxisMode === 'school' ? 'checked' : ''}> 学校</label>
            <label><input type="radio" name="xAxisMode" value="organization" onchange="syncAndDrawHeightChart('organization', '${dataSource}')" ${savedXAxisMode === 'organization' ? 'checked' : ''}> 组织</label>
            <label><input type="radio" name="xAxisMode" value="attribute" onchange="syncAndDrawHeightChart('attribute', '${dataSource}')" ${savedXAxisMode === 'attribute' ? 'checked' : ''}> 自定义属性</label>
        </div>
        <div id="heightChartWrapper">
            <div id="yAxisContainer"></div>
            <div id="chart-scroll-area">
                <div id="heightChartArea">
                    <div id="chartGridAndPoints"></div>
                </div>
                <div id="xAxisContainer"></div>
            </div>
        </div>
    `;

    // 这之后的所有代码都包含在函数内部，直到最后的 `}`
    let categories = [], categoryLabels = [];
    const schoolTranslations = new Map([
        ['神浜市立大附属', '神滨市立大学附属学校'], ['水名女学園', '水名女子学园'], ['参京院教育学園', '参京院教育学园'],
        ['栄総合学園', '荣综合学园'], ['中央学園', '中央学园'], ['南凪自由学園', '南凪自由学园'],
        ['工匠学舎', '工匠学舍'], ['大東学院', '大东学院'], ['聖リリアンナ学園', '圣莉莉安娜学园'],
        ['神浜未来アカデミー', '神滨未来学院'], ['湯の花国際中学・高等学校', '汤之花国际中学・高等学校'], ['松宮市立第一中学校', '松宫市立第一中学'],
        ['霧峰村立霧峰中学校', '雾峰村立雾峰中学'], ['虎屋町学園', '虎屋町学园'], ['竜ケ崎学院', '龙崎学院'],
        ['蛇の宮中学・高等学校', '蛇之宫中学・高等学校'], ['宝崎順心学園', '宝崎顺心学园'], ['宝崎市立光塚中等教育学校', '宝崎市立光冢中等教育学校'],
        ['見滝原中学校', '见泷原中学'], ['白羽女学院', '白羽女学院'], ['あすなろ市立南部中学校', '翌桧市立南部中学'],
        ['茜ヶ咲中学校', '茜咲中学'], ['聖乙女学園', '圣乙女学园'], ['その他学校', '其他学校']
    ]);

    switch (savedXAxisMode) {
        case 'age':
            for(let i = 10; i <= 20; i++) categories.push(`${i}`); 
            categories.push('其他');
            categoryLabels = categories.map(c => c === '其他' ? '其他年龄' : `${c}岁`);
            break;
        case 'grade':
            categories = ['小学生', '中1', '中2', '中3', '高1', '高2', '高3', 'その他', '学年不明'];
            categoryLabels = ['小学生', '初一', '初二', '初三', '高一', '高二', '高三', '其他', '年级不详'];
            break;
        case 'school':
            categories = Array.from(schoolTranslations.keys());
            categoryLabels = Array.from(schoolTranslations.values());
            break;
        case 'organization':
            categories = ['マギアユニオン', '時女一族', 'プロミストブラッド', 'ネオマギウス', 'フォークロア', 'ピュエラケア', 'ヒストリア'];
            categoryLabels = ['神滨魔法联盟', '时女一族', 'PROMISED BLOOD', 'Neo-Magius', 'Folklore of 0', 'Puella Care', '历史篇'];
            break;
        case 'attribute':
            const attributeCheckboxes = document.querySelectorAll('#at_form input[type="checkbox"]:checked');
            attributeCheckboxes.forEach(cb => categories.push(cb.value));
            if (categories.length === 0) categories = ['未勾选任何属性'];
            categoryLabels = categories;
            break;
    }

    const chartGrid = document.getElementById('chartGridAndPoints');
    const xAxisContainer = document.getElementById('xAxisContainer');
  document.getElementById('yAxisContainer').innerHTML = ''; // 保留这行来清理外部容器
for (let h = 180; h >= 120; h -= 5) {
    const label = document.createElement('span');
    label.textContent = `${h}cm`;
    label.style.position = 'absolute';
    label.style.left = '5px'; // 恢复：左对齐
    const yPosPercent = ((h - 120) / (180 - 120)) * 100;
    label.style.bottom = `${yPosPercent}%`; // 恢复：移除错误的-7px
    label.style.transform = 'translateY(-50%)'; // 恢复：使用transform来垂直居中对齐
    chartGrid.appendChild(label); // 恢复：将刻度标签写回到图表网格内部
}
    const columnMinWidth = 120;
    const totalGridWidth = categories.length * columnMinWidth;
    chartGrid.style.minWidth = `${totalGridWidth}px`;
    chartGrid.style.gridTemplateColumns = `repeat(${categories.length}, 1fr)`;
    xAxisContainer.style.minWidth = `${totalGridWidth}px`;
    xAxisContainer.style.gridTemplateColumns = `repeat(${categories.length}, 1fr)`;
    categoryLabels.forEach(label => {
        xAxisContainer.innerHTML += `<div class="x-axis-label">${label}</div>`;
        chartGrid.innerHTML += `<div class="grid-column"></div>`;
    });
    
    if (currentViewMode === 'scatter') {
        const columnCounters = new Map(categories.map(cat => [cat, 0]));
        sourceDataKeys.forEach(girlKey => {
            if (!callTable.has(girlKey)) return;
            const details = callTable.get(girlKey);
            const height = parseInt(details.get("身高"), 10);
            if (isNaN(height) || height < 120 || height > 180) return;

            const japaneseNameMatch = girlKey.match(/\(([^/]+)/);
            const baseJapaneseName = japaneseNameMatch ? japaneseNameMatch[1].trim() : girlKey;
            const attributes = new Set();
            charaAttribute.forEach((attrs, versionedName) => {
                if (versionedName.startsWith(baseJapaneseName)) {
                    attrs.forEach(attr => attributes.add(attr));
                }
            });
            
            const shortNameMatch = girlKey.match(/^(.*?)\s*\(/);
            const shortName = shortNameMatch ? shortNameMatch[1].trim() : girlKey.trim();
            const ageStr = details.get("年龄") || "年龄不详";

            let targetCategory = null;
            switch (savedXAxisMode) {
                case 'age':
                    const ageNum = parseInt(ageStr);
                    targetCategory = !isNaN(ageNum) && ageNum >= 10 && ageNum <= 20 ? `${ageNum}` : '其他';
                    break;
                case 'grade': case 'school': case 'organization': case 'attribute':
                    for (const cat of categories) {
                        if (attributes.has(cat)) { targetCategory = cat; break; }
                    }
                    if (!targetCategory && savedXAxisMode === 'school') { targetCategory = 'その他学校'; }
                    break;
            }

            if (!targetCategory || !categories.includes(targetCategory)) return;
            const yPosPercent = (height - 120) / (180 - 120) * 100;
            const catIndex = categories.indexOf(targetCategory);
            const counter = columnCounters.get(targetCategory);
            
            const itemsPerRow = 4;
            const xJitter = (counter % itemsPerRow - Math.floor(itemsPerRow / 2) + 0.5) * 12;

            const point = document.createElement('div');
            point.className = 'chart-point';
            point.style.left = `calc(${(catIndex + 0.5) * (100 / categories.length)}% + ${xJitter}px)`;
            point.style.bottom = `calc(${yPosPercent}% - 20px)`;

            let schoolAttr = [...attributes].find(attr => schoolTranslations.has(attr)) || '不明';
            let translatedSchool = schoolTranslations.get(schoolAttr) || schoolAttr;
            point.title = `${shortName}\n身高: ${details.get("身高")}\n年龄: ${ageStr}\n学校: ${translatedSchool}`;
            point.innerHTML = `<img src="./img/png/${shortName}.png" alt="${shortName}">`;
            
            chartGrid.appendChild(point);
            columnCounters.set(targetCategory, counter + 1);
        });
    } else if (currentViewMode === 'bar') {
        const categoryData = new Map();
        categories.forEach(cat => categoryData.set(cat, []));

        sourceDataKeys.forEach(girlKey => {
            if (!callTable.has(girlKey)) return;
            const details = callTable.get(girlKey);
            const height = parseInt(details.get("身高"), 10);
            if (isNaN(height)) return;

            const japaneseNameMatch = girlKey.match(/\(([^/]+)/);
            const baseJapaneseName = japaneseNameMatch ? japaneseNameMatch[1].trim() : girlKey;
            const attributes = new Set();
            charaAttribute.forEach((attrs, versionedName) => {
                if (versionedName.startsWith(baseJapaneseName)) {
                    attrs.forEach(attr => attributes.add(attr));
                }
            });

            let targetCategory = null;
            switch (savedXAxisMode) {
                case 'age':
                    const ageNum = parseInt(details.get("年龄") || "年龄不详");
                    targetCategory = !isNaN(ageNum) && ageNum >= 10 && ageNum <= 20 ? `${ageNum}` : '其他';
                    break;
                case 'grade': case 'school': case 'organization': case 'attribute':
                    for (const cat of categories) {
                        if (attributes.has(cat)) { targetCategory = cat; break; }
                    }
                    if (!targetCategory && savedXAxisMode === 'school') { targetCategory = 'その他学校'; }
                    break;
            }

            if (targetCategory && categoryData.has(targetCategory)) {
                categoryData.get(targetCategory).push(height);
            }
        });

        categoryData.forEach((heights, category) => {
            if (heights.length === 0) return;

            const sum = heights.reduce((a, b) => a + b, 0);
            const avg = sum / heights.length;
            const catIndex = categories.indexOf(category);
            if (catIndex === -1) return;

            const barHeightPercent = Math.max(0, (avg - 120) / (180 - 120) * 100);
            
const barWrapper = chartGrid.querySelectorAll('.grid-column')[catIndex];            if (!barWrapper) return;
            
            barWrapper.style.display = 'flex';
            barWrapper.style.alignItems = 'flex-end';
            barWrapper.style.justifyContent = 'center';

            const bar = document.createElement('div');
            bar.className = 'height-bar';
            bar.style.height = `${barHeightPercent}%`;

            const label = document.createElement('div');
            label.className = 'height-bar-label';
            label.textContent = `${avg.toFixed(1)}`;
            
            bar.appendChild(label);
            barWrapper.appendChild(bar);
        });
    }
}
</script>

</body>

</html>